<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'"
    />
    <title>RemoteLink</title>
    <link rel="stylesheet" href="./node_modules/xterm/css/xterm.css" />
    <link rel="stylesheet" href="styles.css" />
    <!-- xterm 라이브러리 -->
    <script src="./node_modules/xterm/lib/xterm.js"></script>
    <script src="./node_modules/xterm-addon-fit/lib/xterm-addon-fit.js"></script>
  </head>
  <body>
    <div class="container">
      <!-- 사이드바: 서버 목록 -->
      <aside class="sidebar">
        <div class="sidebar-header">
          <h1>🔗 RemoteLink</h1>
          <button id="btn-add-server" class="btn-add">+ 서버 추가</button>
        </div>
        <ul id="server-list" class="server-list">
          <!-- 서버 목록이 여기에 렌더링 -->
        </ul>
      </aside>

      <!-- 메인 영역 -->
      <main class="main-content">
        <!-- 환영 메시지 (서버 미선택 시) -->
        <div id="welcome-section" class="welcome-message">
          <h2>👋 환영합니다!</h2>
          <p>왼쪽에서 서버를 선택하거나 새 서버를 추가하세요.</p>
        </div>

        <!-- 서버 상세 (선택 시) -->
        <div id="server-detail" class="server-detail hidden">
          <!-- 서버 정보 헤더 -->
          <div class="detail-header">
            <h2 id="detail-name">서버 이름</h2>
            <div class="detail-actions">
              <button id="btn-edit-server" class="btn-secondary">수정</button>
              <button id="btn-delete-server" class="btn-danger">삭제</button>
            </div>
          </div>
          <div class="detail-info">
            <p><strong>Host:</strong> <span id="detail-host">-</span></p>
            <p><strong>Port:</strong> <span id="detail-port">-</span></p>
            <p>
              <strong>Username:</strong> <span id="detail-username">-</span>
            </p>
            <p><strong>Key File:</strong> <span id="detail-keyfile">-</span></p>
          </div>

          <!-- 연결 대상 선택 & 테스트 -->
          <div class="connection-section">
            <div class="connection-target">
              <label for="connection-target">연결 대상:</label>
              <select id="connection-target">
                <option value="host">🖥️ 호스트</option>
                <!-- 컨테이너 목록은 JS로 동적 추가 -->
              </select>
              <button
                id="btn-refresh-containers"
                class="btn-icon"
                title="컨테이너 목록 새로고침"
              >
                🔄컨테이너 불러오기
              </button>
              <button id="btn-test-connection" class="btn-primary">
                🪢 연결 테스트
              </button>
            </div>
            <div id="connection-status" class="connection-status"></div>
          </div>

          <hr />

          <!-- 메인 탭 -->
          <div class="main-tabs">
            <button id="tab-file-transfer" class="main-tab active">📁 파일 전송</button>
            <button id="tab-terminal" class="main-tab">💻 터미널</button>
          </div>

          <!-- 파일 전송 섹션 -->
          <div id="file-transfer-section" class="file-transfer-section">
            <h3>📁 파일 전송</h3>

            <!-- 원격 경로 입력 -->
            <div class="remote-path-section">
              <label for="remote-path"
                >원격 경로 <br />
                1. 원격 서버에 존재하는 폴더 경로여야 합니다.<br />
                2. Username의 사용자가 해당 폴f더 수정 권한이 있어야 합니다.
              </label>
              <div class="remote-path-input-group">
                <input
                  type="text"
                  id="remote-path"
                  list="remote-path-list"
                  placeholder="/home/ubuntu/app"
                />
                <datalist id="remote-path-list">
                  <!-- 저장된 경로 목록은 JS로 동적 추가 -->
                </datalist>
                <button
                  id="btn-save-path"
                  class="btn-icon"
                  title="현재 경로 저장"
                >
                  💾
                </button>
                <button
                  id="btn-manage-paths"
                  class="btn-icon"
                  title="저장된 경로 관리"
                >
                  ⚙️
                </button>
              </div>
            </div>

            <!-- 드래그앤드롭 영역 -->
            <div id="drop-zone" class="drop-zone">
              <p>📂 파일 또는 폴더를 여기에 드래그하세요</p>
              <p class="drop-zone-sub">또는</p>
              <div class="file-buttons">
                <button id="btn-select-file" class="btn-secondary">
                  파일 선택
                </button>
                <button id="btn-select-folder" class="btn-secondary">
                  폴더 선택
                </button>
              </div>
            </div>

            <!-- 전송 대기 목록 -->
            <div id="transfer-queue" class="transfer-queue hidden">
              <h4>전송 대기 목록</h4>
              <ul id="queue-list"></ul>
              <div class="queue-actions">
                <button id="btn-clear-queue" class="btn-secondary">
                  목록 비우기
                </button>
                <button id="btn-start-transfer" class="btn-primary">
                  🚀 전송 시작
                </button>
              </div>
            </div>

            <!-- 전송 상태 -->
            <div id="transfer-status" class="transfer-status hidden">
              <div class="progress-info">
                <span id="transfer-filename">파일명</span>
                <span id="transfer-percent">0%</span>
              </div>
              <div class="progress-bar">
                <div id="progress-fill" class="progress-fill"></div>
              </div>
              <p id="transfer-result" class="transfer-result"></p>
            </div>
          </div>

          <!-- 터미널 섹션 -->
          <div id="terminal-section" class="terminal-section hidden">
            <div id="terminal-container" class="terminal-container">
              <!-- 터미널 탭 -->
              <div id="terminal-tabs" class="terminal-tabs">
                <button id="btn-new-terminal" class="btn-new-terminal">+ ▼</button>
              </div>
              <!-- 드롭다운 메뉴 -->
              <div id="new-terminal-dropdown" class="new-terminal-dropdown hidden">
                <!-- JS로 동적 추가 -->
              </div>
              <!-- 터미널 내용 -->
              <div id="terminal-content" class="terminal-content">
                <div class="terminal-placeholder">
                  <p>💻 새 터미널을 열려면 [+] 버튼을 클릭하세요</p>
                </div>
              </div>
              <!-- 리사이즈 핸들 -->
              <div id="terminal-resize-handle" class="terminal-resize-handle"></div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- 서버 추가/수정 모달 -->
    <div id="server-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="modal-title">서버 추가</h2>
          <button id="btn-close-modal" class="btn-close">&times;</button>
        </div>
        <form id="server-form">
          <input type="hidden" id="form-id" />

          <div class="form-group">
            <label for="form-name">서버 이름</label>
            <input
              type="text"
              id="form-name"
              placeholder="예: OCI 운영서버"
              required
            />
          </div>

          <div class="form-group">
            <label for="form-host">Host (IP)</label>
            <input
              type="text"
              id="form-host"
              placeholder="예: 123.456.789.0"
              required
            />
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="form-port">Port</label>
              <input type="number" id="form-port" value="22" required />
            </div>
            <div class="form-group">
              <label for="form-username">Username</label>
              <input
                type="text"
                id="form-username"
                placeholder="예: ubuntu"
                required
              />
            </div>
          </div>

          <div class="form-group">
            <label for="form-keyfile">SSH Key 파일</label>
            <div class="file-input-group">
              <input
                type="text"
                id="form-keyfile"
                placeholder="키 파일 경로"
                readonly
              />
              <button
                type="button"
                id="btn-select-keyfile"
                class="btn-secondary"
              >
                찾기
              </button>
            </div>
          </div>

          <div class="form-group">
            <label for="form-remote-path">기본 원격 경로 (선택)</label>
            <input
              type="text"
              id="form-remote-path"
              placeholder="예: /home/ubuntu/app"
            />
          </div>

          <div class="modal-footer">
            <button type="button" id="btn-cancel" class="btn-secondary">
              취소
            </button>
            <button type="submit" class="btn-primary">저장</button>
          </div>
        </form>
      </div>
    </div>

    <!-- 원격 경로 관리 모달 -->
    <div id="paths-modal" class="modal hidden">
      <div class="modal-content modal-small">
        <div class="modal-header">
          <h2>저장된 원격 경로</h2>
          <button id="btn-close-paths-modal" class="btn-close">&times;</button>
        </div>
        <div class="paths-list-container">
          <ul id="saved-paths-list" class="saved-paths-list">
            <!-- 저장된 경로 목록은 JS로 동적 추가 -->
          </ul>
          <p id="no-paths-message" class="no-paths-message hidden">
            저장된 경로가 없습니다.
          </p>
        </div>
      </div>
    </div>

    <script src="renderer/index.js" type="module"></script>
  </body>
</html>
